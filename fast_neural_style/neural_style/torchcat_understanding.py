# 对torch.cat() 的理解
# 在默认维度dim=0上进行cat
# 输入为Tensor（2，3，4）
# 5个相同的Tensor进行cat
# 则结果为Tensor（2*5，3，4）

import torch
x = torch.randn(2, 3)
x
# Out[5]:
# tensor([[-0.1827, -0.4710, -1.2958],
#         [-1.7770, -1.1736, -1.4545]])

list = []
list.append(x)
list.append(x)
list.append(x)
list.append(x)
list.append(x)
list
# Out[13]:
# [tensor([[-0.1827, -0.4710, -1.2958],
#          [-1.7770, -1.1736, -1.4545]]), tensor([[-0.1827, -0.4710, -1.2958],
#          [-1.7770, -1.1736, -1.4545]]), tensor([[-0.1827, -0.4710, -1.2958],
#          [-1.7770, -1.1736, -1.4545]]), tensor([[-0.1827, -0.4710, -1.2958],
#          [-1.7770, -1.1736, -1.4545]]), tensor([[-0.1827, -0.4710, -1.2958],
#          [-1.7770, -1.1736, -1.4545]])]
torch.cat(list)
# Out[14]:
# tensor([[-0.1827, -0.4710, -1.2958],
#         [-1.7770, -1.1736, -1.4545],
#         [-0.1827, -0.4710, -1.2958],
#         [-1.7770, -1.1736, -1.4545],
#         [-0.1827, -0.4710, -1.2958],
#         [-1.7770, -1.1736, -1.4545],
#         [-0.1827, -0.4710, -1.2958],
#         [-1.7770, -1.1736, -1.4545],
#         [-0.1827, -0.4710, -1.2958],
#         [-1.7770, -1.1736, -1.4545]])
catresult = torch.cat(list)
catresult
# Out[16]:
# tensor([[-0.1827, -0.4710, -1.2958],
#         [-1.7770, -1.1736, -1.4545],
#         [-0.1827, -0.4710, -1.2958],
#         [-1.7770, -1.1736, -1.4545],
#         [-0.1827, -0.4710, -1.2958],
#         [-1.7770, -1.1736, -1.4545],
#         [-0.1827, -0.4710, -1.2958],
#         [-1.7770, -1.1736, -1.4545],
#         [-0.1827, -0.4710, -1.2958],
#         [-1.7770, -1.1736, -1.4545]])
catresult.size()
# Out[17]: torch.Size([10, 3])


y = torch.rand(2,3,4)
y
# Out[21]:
# tensor([[[0.5890, 0.9176, 0.9235, 0.6703],
#          [0.6159, 0.0405, 0.0256, 0.7143],
#          [0.7281, 0.9476, 0.8337, 0.6193]],
#         [[0.8927, 0.3782, 0.2682, 0.2189],
#          [0.6595, 0.9985, 0.5052, 0.8361],
#          [0.2429, 0.2807, 0.0764, 0.0605]]])
ylist = []
ylist.append(y)
ylist.append(y)
ylist.append(y)
ylist.append(y)
ylist.append(y)
torch.cat(ylist)
# Out[28]:
# tensor([[[0.5890, 0.9176, 0.9235, 0.6703],
#          [0.6159, 0.0405, 0.0256, 0.7143],
#          [0.7281, 0.9476, 0.8337, 0.6193]],
#         [[0.8927, 0.3782, 0.2682, 0.2189],
#          [0.6595, 0.9985, 0.5052, 0.8361],
#          [0.2429, 0.2807, 0.0764, 0.0605]],
#         [[0.5890, 0.9176, 0.9235, 0.6703],
#          [0.6159, 0.0405, 0.0256, 0.7143],
#          [0.7281, 0.9476, 0.8337, 0.6193]],
#         [[0.8927, 0.3782, 0.2682, 0.2189],
#          [0.6595, 0.9985, 0.5052, 0.8361],
#          [0.2429, 0.2807, 0.0764, 0.0605]],
#         [[0.5890, 0.9176, 0.9235, 0.6703],
#          [0.6159, 0.0405, 0.0256, 0.7143],
#          [0.7281, 0.9476, 0.8337, 0.6193]],
#         [[0.8927, 0.3782, 0.2682, 0.2189],
#          [0.6595, 0.9985, 0.5052, 0.8361],
#          [0.2429, 0.2807, 0.0764, 0.0605]],
#         [[0.5890, 0.9176, 0.9235, 0.6703],
#          [0.6159, 0.0405, 0.0256, 0.7143],
#          [0.7281, 0.9476, 0.8337, 0.6193]],
#         [[0.8927, 0.3782, 0.2682, 0.2189],
#          [0.6595, 0.9985, 0.5052, 0.8361],
#          [0.2429, 0.2807, 0.0764, 0.0605]],
#         [[0.5890, 0.9176, 0.9235, 0.6703],
#          [0.6159, 0.0405, 0.0256, 0.7143],
#          [0.7281, 0.9476, 0.8337, 0.6193]],
#         [[0.8927, 0.3782, 0.2682, 0.2189],
#          [0.6595, 0.9985, 0.5052, 0.8361],
#          [0.2429, 0.2807, 0.0764, 0.0605]]])
caty = torch.cat(ylist)
caty
# Out[30]:
# tensor([[[0.5890, 0.9176, 0.9235, 0.6703],
#          [0.6159, 0.0405, 0.0256, 0.7143],
#          [0.7281, 0.9476, 0.8337, 0.6193]],
#         [[0.8927, 0.3782, 0.2682, 0.2189],
#          [0.6595, 0.9985, 0.5052, 0.8361],
#          [0.2429, 0.2807, 0.0764, 0.0605]],
#         [[0.5890, 0.9176, 0.9235, 0.6703],
#          [0.6159, 0.0405, 0.0256, 0.7143],
#          [0.7281, 0.9476, 0.8337, 0.6193]],
#         [[0.8927, 0.3782, 0.2682, 0.2189],
#          [0.6595, 0.9985, 0.5052, 0.8361],
#          [0.2429, 0.2807, 0.0764, 0.0605]],
#         [[0.5890, 0.9176, 0.9235, 0.6703],
#          [0.6159, 0.0405, 0.0256, 0.7143],
#          [0.7281, 0.9476, 0.8337, 0.6193]],
#         [[0.8927, 0.3782, 0.2682, 0.2189],
#          [0.6595, 0.9985, 0.5052, 0.8361],
#          [0.2429, 0.2807, 0.0764, 0.0605]],
#         [[0.5890, 0.9176, 0.9235, 0.6703],
#          [0.6159, 0.0405, 0.0256, 0.7143],
#          [0.7281, 0.9476, 0.8337, 0.6193]],
#         [[0.8927, 0.3782, 0.2682, 0.2189],
#          [0.6595, 0.9985, 0.5052, 0.8361],
#          [0.2429, 0.2807, 0.0764, 0.0605]],
#         [[0.5890, 0.9176, 0.9235, 0.6703],
#          [0.6159, 0.0405, 0.0256, 0.7143],
#          [0.7281, 0.9476, 0.8337, 0.6193]],
#         [[0.8927, 0.3782, 0.2682, 0.2189],
#          [0.6595, 0.9985, 0.5052, 0.8361],
#          [0.2429, 0.2807, 0.0764, 0.0605]]])
caty.size()
# Out[31]: torch.Size([10, 3, 4])